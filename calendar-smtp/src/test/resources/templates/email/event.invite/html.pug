mixin displayAttendees(attendees, organizer)
  ul(style='padding-inline-start: 16px; margin: 0;')
    li
      span(style='font-weight: 500') #{organizer.cn}
      span(style='color: #787878;') &nbsp;&lt;#{organizer.email}&gt;
      span(style='font-weight: 500') &nbsp;(#{translate.get('organizer')})
    each attendee, attendeeEmail in attendees
      if (attendeeEmail !== organizer.email)
        li
          span(style='font-weight: 500') #{attendee.cn}
          span(style='color: #787878;') &nbsp;&lt;#{attendeeEmail}&gt;

mixin displayResources(resources)
  - var first = true;
  span
    each resource, key in resources
      if !first
        | ,
      = resource.cn
      - first = false

doctype html
head
  title
  // [if !mso] <!
  meta(http-equiv='X-UA-Compatible' content='IE=edge')
  // <![endif]
  meta(http-equiv='Content-Type' content='text/html; charset=UTF-8')
  meta(name='viewport' content='width=device-width, initial-scale=1')
  style(type='text/css').
    #outlook a {
    padding: 0;
    }
    body {
    margin: 0;
    padding: 0;
    -webkit-text-size-adjust: 100%;
    -ms-text-size-adjust: 100%;
    }
    table,
    td {
    border-collapse: collapse;
    mso-table-lspace: 0pt;
    mso-table-rspace: 0pt;
    }
    img {
    border: 0;
    height: auto;
    line-height: 100%;
    outline: none;
    text-decoration: none;
    -ms-interpolation-mode: bicubic;
    }
    p {
    display: block;
    margin: 13px 0;
    }
  //if mso
    xml
      o:officedocumentsettings
        o:allowpng
          o:pixelsperinch 96
  //if lte mso 11
    style(type='text/css').
      .mj-outlook-group-fix { width:100% !important; }
  // [if !mso] <!
  link(href='https://fonts.googleapis.com/css?family=Roboto:300,400,500,700' rel='stylesheet' type='text/css')
  style(type='text/css').
    @import url(https://fonts.googleapis.com/css?family=Roboto:300,400,500,700);
  // <![endif]
  style(type='text/css').
    @media only screen and (min-width:480px) {
    .mj-column-per-100 {
    width: 100% !important;
    max-width: 100%;
    }
    }
  style(type='text/css').
div(style='')
  //if mso | IE
    table(align='center' border='0' cellpadding='0' cellspacing='0' style='width:600px;' width='600')
      tr
        td(style='line-height:0px;font-size:0px;mso-line-height-rule:exactly;')
  div(style='margin:0px auto;max-width:600px;')
    table(align='center' border='0' cellpadding='0' cellspacing='0' role='presentation' style='width:100%;')
      tbody
        tr
          td(style='direction:ltr;font-size:0px;padding:20px 0;padding-bottom:0;text-align:center;')
            //if mso | IE
              table(role='presentation' border='0' cellpadding='0' cellspacing='0')
                tr
                  td(width='600px')
                    table(align='center' border='0' cellpadding='0' cellspacing='0' style='width:600px;' width='600')
                      tr
                        td(style='line-height:0px;font-size:0px;mso-line-height-rule:exactly;')
            div(style='margin:0px auto;max-width:600px;')
              table(align='center' border='0' cellpadding='0' cellspacing='0' role='presentation' style='width:100%;')
                tbody
                  tr
                    td(style='direction:ltr;font-size:0px;padding:20px 0;padding-bottom:0;padding-top:0;text-align:center;')
                      //if mso | IE
                        table(role='presentation' border='0' cellpadding='0' cellspacing='0')
                          tr
                            td.invitation-title-container-outlook(style='vertical-align:top;width:600px;')
                      .mj-column-per-100.mj-outlook-group-fix.invitation-title-container(style='background: #deffe1; border-radius: 4px; border: 1px solid #deffe1; font-size: 0px; text-align: left; direction: ltr; display: inline-block; vertical-align: top; width: 100%;')
                        table(border='0' cellpadding='0' cellspacing='0' role='presentation' width='100%')
                          tbody
                            tr
                              td(style='vertical-align:top;padding-top:4px;padding-bottom:4px;')
                                table(border='0' cellpadding='0' cellspacing='0' role='presentation' style='' width='100%')
                                  tbody
                                    tr
                                      td(align='left' style='font-size:0px;padding:0;padding-top:8px;padding-right:20px;padding-bottom:8px;padding-left:20px;word-break:break-word;')
                                        div(style='font-family:Roboto;font-size:16px;line-height:1;text-align:left;color:#222222;')
                                          span(style='font-weight: 500;') #{content.event.organizer.cn}
                                          span &nbsp;#{content.inviteMessage}
                      //if mso | IE
                        td.content-outlook(style='vertical-align:top;width:600px;')
                      .mj-column-per-100.mj-outlook-group-fix.content(style='border: 1px solid #ccc; border-radius: 4px; margin-top: 24px; font-size: 0px; text-align: left; direction: ltr; display: inline-block; vertical-align: top; width: 100%;')
                        table(border='0' cellpadding='0' cellspacing='0' role='presentation' style='vertical-align:top;' width='100%')
                          tbody
                            tr
                              td(align='left' style='font-size:0px;padding:20px;word-break:break-word;')
                                div(style='font-family:Roboto;font-size:20px;font-weight:500;line-height:1;text-align:left;color:#434343;') #{content.event.summary}
                            tr
                              td(align='left' style='font-size:0px;padding:20px;padding-top:0px;word-break:break-word;')
                                table(cellpadding='4px' cellspacing='0' width='100%' border='0' style='color:#434343;font-family:Roboto;font-size:14px;line-height:22px;table-layout:auto;width:100%;border:none;')
                                  tr
                                    td(valign='top' style='min-width: 80px;')
                                      strong #{translate.get('time')}
                                    td
                                      if (!content.event.allDay)
                                        span(style='display: inline-block;')
                                          if (content.event.start.date === content.event.end.date)
                                            | #{content.event.start.fullDateTime} - #{content.event.end.time}
                                          else
                                            | #{content.event.start.fullDateTime} - #{content.event.end.fullDateTime}
                                        span(style='color: #787878; font-weight: 400; display: inline-block;') &nbsp;#{content.event.start.timezone}
                                      else
                                        span(style='display: inline-block;')
                                          if (content.event.start.date === content.event.end.date)
                                            | #{content.event.start.fullDate} (#{translate.get('all_day')})
                                          else
                                            | #{content.event.start.fullDate} - #{content.event.end.fullDate} (#{translate.get('all_day')})
                                      if (content.seeInCalendarLink)
                                        | &nbsp;(
                                        a.link(href=content.seeInCalendarLink style='text-decoration: none; color: #4d91c9;') #{translate.get('see_in_calendar')}
                                        | )
                                  if (content.event.location)
                                    tr
                                      td(style='min-width: 96px;' valign='top')
                                        strong #{translate.get('location')}
                                      td
                                        if (content.event.isLocationAValidURL)
                                          if (content.event.isLocationAnAbsoluteURL)
                                            a.link(href=content.event.location style='text-decoration: none; color: #4d91c9;') #{content.event.location}
                                          else
                                            a.link(href=`//${content.event.location}` style='text-decoration: none; color: #4d91c9;') #{content.event.location}
                                        else
                                          | #{content.event.location} (
                                          a(href=`https://www.openstreetmap.org/search?query=${content.event.location}`) #{translate.get('see_in_map')}
                                          | )
                                  tr
                                    td(valign='top')
                                      strong #{translate.get('attendees')}
                                    td
                                      +displayAttendees(content.event.attendees, content.event.organizer)
                                  if (content.event.hasResources)
                                    tr
                                      td(valign='top')
                                        strong #{translate.get('resources')}
                                      td
                                        +displayResources(content.event.resources)
                                  if (content.event.description)
                                    tr
                                      td(valign='top')
                                        strong #{translate.get('notes')}
                                      td #{content.event.description}
                            if (content.method !== 'CANCEL')
                              tr
                                td.part-table(align='left' style='background: #f7f7f7; font-size: 0px; padding: 20px; padding-top: 16px; padding-bottom: 16px; word-break: break-word;')
                                  table(cellpadding='0' cellspacing='0' width='100%' border='0' style='color:#000000;font-family:Roboto;font-size:13px;line-height:22px;table-layout:auto;width:100%;border:none;')
                                    tr
                                      td.part-message-container(colspan='3' style='font-size: 16px; font-family: Roboto; color: #333; font-weight: 500; padding-bottom: 12px;') Will you attend this event?
                                    tr
                                      td.part-button-container(style='white-space: nowrap;')
                                        a.part-button(href='https://openpaas.linagora.com/calendar/#/calendar/participation/?jwt=eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdHRlbmRlZUVtYWlsIjoiaHBoYW5AbGluYWdvcmEuY29tIiwib3JnYW5pemVyRW1haWwiOiJ2dHRyYW5AbGluYWdvcmEuY29tIiwidWlkIjoiOWU2MDcxYmItZDQxYi00NzkwLWFlMDItYjI1MjhkNTU5YmM3IiwiY2FsZW5kYXJVUkkiOiI2MDUzMDIyYzlkYTVlZjAwMWY0MzBiNDMiLCJhY3Rpb24iOiJBQ0NFUFRFRCIsImlhdCI6MTc0ODgzMTk3OH0.oXKCYE8hcyMc63KIhbT2vaO_CesEhmEpJMqrEEiL0_Jwblzw4fqmfLIVxCAMeMkqxpDPKIzy-AfK0IVXeM-ICP6p9heLPPb-bxBJ5vjOCXFfH9cAPZ31mGi77cw32Z-FNLTcVLhmV-eV6j5rJI5qhYV4852iKuUxFsRsIyqm0f0DoEKOIqBhOu_VatmvYQwBAXGV8NHiIEYzjc7plSNI36DhuBZGnCxtJ6cgGZNO1fHbbW2HB7GDtyYwHcC1qW7y0vI78Zr30Sb9x84hkbHGFpMo9koz7lAh2oSE7PBX7toAauf7VVEmW48Ekjgw7p3UXIbfN1ODIOLv8RBzP-kuPg' style='display: block; color: #333; text-align: center; margin-right: 8px; min-width: 64px; font-size: 16px; text-decoration: none; padding: 6px 8px; background: #fff; border-radius: 18px; border: 1px solid #ccc;')
                                          span(style='color: green; font-size: 18px;') &nbsp;&check;&nbsp;
                                          | &nbsp;Yes
                                      td.part-button-container(style='white-space: nowrap;')
                                        a.part-button(href='https://openpaas.linagora.com/calendar/#/calendar/participation/?jwt=eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdHRlbmRlZUVtYWlsIjoiaHBoYW5AbGluYWdvcmEuY29tIiwib3JnYW5pemVyRW1haWwiOiJ2dHRyYW5AbGluYWdvcmEuY29tIiwidWlkIjoiOWU2MDcxYmItZDQxYi00NzkwLWFlMDItYjI1MjhkNTU5YmM3IiwiY2FsZW5kYXJVUkkiOiI2MDUzMDIyYzlkYTVlZjAwMWY0MzBiNDMiLCJhY3Rpb24iOiJURU5UQVRJVkUiLCJpYXQiOjE3NDg4MzE5Nzh9.jfZBpaF2IzEk_icd_USxeleFc1TpJsbTatUvWdoOnTsRSGnfUwYMVYT9qz5Wtc2fdRsHq33frXuI24YjQGIkfupyqK7SehV0F5jpbkGrTFMRsjAOSNvB7-vAzHy8vJXN8CxGNFgqqR1oLaDIafdKuGHwkhNTTDU-6sDC9cuAQCf0mpjWa7xndVIVGYIlQSqzIGOKYGz-JeZFk2ldf0LBr0HNb40wHkB3ZJabQSTlEaLnEWsMXvvukQmBgZDLZO-VgjKHmgbqw-77826FyW2CX85B6VNOFxjYqxL3CrbBRBBtc9JS5ZDVEsCdm6AmIM82RrqiLX6Pn8LA4uptluNEqg' style='display: block; color: #333; text-align: center; margin-right: 8px; min-width: 64px; font-size: 16px; text-decoration: none; padding: 6px 8px; background: #fff; border-radius: 18px; border: 1px solid #ccc;')
                                          span(style='color: orange; font-weight: 500;') &nbsp;?&nbsp;
                                          | &nbsp;Maybe
                                      td.part-button-container(style='white-space: nowrap;')
                                        a.part-button(href='https://openpaas.linagora.com/calendar/#/calendar/participation/?jwt=eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdHRlbmRlZUVtYWlsIjoiaHBoYW5AbGluYWdvcmEuY29tIiwib3JnYW5pemVyRW1haWwiOiJ2dHRyYW5AbGluYWdvcmEuY29tIiwidWlkIjoiOWU2MDcxYmItZDQxYi00NzkwLWFlMDItYjI1MjhkNTU5YmM3IiwiY2FsZW5kYXJVUkkiOiI2MDUzMDIyYzlkYTVlZjAwMWY0MzBiNDMiLCJhY3Rpb24iOiJERUNMSU5FRCIsImlhdCI6MTc0ODgzMTk3OH0.PXpEqJjwRzkxEy3KVsHmJSShFx7870VEHspFZ5G6h6o9Z2VDpBv5IWT9FfFwLZwhZiQHbQJKGre7IUWQLRvNEvQ2hpqPTlS60YqwVIFyKrNsYzF46dnSDOg12ueQCwheIDJ7OL10QYCUImFzpphn8HhMJQPJCZI1wT_ravzWS7Lvk9BMU9UDusQhvGL_Lu_-R45WHsH0BYJk6hz0tn7CsoBKqswGJHlbeuznnp-SXbpAXk5u7USN8vLpMfClcIUkwBD2TdT-Lmp9jshHAq_akbJPl4NmYGvRMmVEtL3kKo3eEwlaWRQLzAHzT2qSyeeoFp6AkW_oKD-wMxA4foI7AQ' style='display: block; color: #333; text-align: center; margin-right: 8px; min-width: 64px; font-size: 16px; text-decoration: none; padding: 6px 8px; background: #fff; border-radius: 18px; border: 1px solid #ccc;')
                                          span(style='color: red; font-size: 18px;') &nbsp;&#x2715;&nbsp;
                                          | &nbsp;No
                                      td.part-button-container--last(style='width: 100%;' width='100%') &nbsp;
                      //if mso | IE
            //if mso | IE
  //if mso | IE
    table(align='center' border='0' cellpadding='0' cellspacing='0' style='width:600px;' width='600')
      tr
        td(style='line-height:0px;font-size:0px;mso-line-height-rule:exactly;')
  div(style='margin:0px auto;max-width:600px;')
    table(align='center' border='0' cellpadding='0' cellspacing='0' role='presentation' style='width:100%;')
      tbody
        tr
          td(style='direction:ltr;font-size:0px;padding:20px 0;text-align:center;')
            //if mso | IE
              table(role='presentation' border='0' cellpadding='0' cellspacing='0')
                tr
                  td(width='600px')
                    table(align='center' border='0' cellpadding='0' cellspacing='0' style='width:600px;' width='600')
                      tr
                        td(style='line-height:0px;font-size:0px;mso-line-height-rule:exactly;')
            div(style='margin:0px auto;max-width:600px;')
              table(align='center' border='0' cellpadding='0' cellspacing='0' role='presentation' style='width:100%;')
                tbody
                  tr
                    td(style='direction:ltr;font-size:0px;padding:0;text-align:center;')
                      //if mso | IE
                        table(role='presentation' border='0' cellpadding='0' cellspacing='0')
                          tr
                            td(style='vertical-align:top;width:600px;')
                      .mj-column-per-100.mj-outlook-group-fix(style='font-size:0px;text-align:left;direction:ltr;display:inline-block;vertical-align:top;width:100%;')
                        table(border='0' cellpadding='0' cellspacing='0' role='presentation' style='vertical-align:top;' width='100%')
                          tbody
                            tr
                              td.warning-text(align='left' style='background-color: #fffaea; border-radius: 4px; font-size: 0px; padding: 12px; word-break: break-word;' bgcolor='#fffaea')
                                div(style='font-family:Roboto;font-size:12px;line-height:1;text-align:left;color:#808080;')
                                  | &#x26A0; Forwarding this invitation could allow any recipient to send a response to the organizer and be added to the guest list, or invite others regardless of their own invitation status, or to modify your RSVP.
                      //if mso | IE
            //if mso | IE
  //if mso | IE

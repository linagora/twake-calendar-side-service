# Server block for tcalendar-side-service.local
server {
    listen 80;
    server_name tcalendar-side-service.local;

    location / {
        proxy_hide_header 'Access-Control-Allow-Origin';

        if ($request_method = 'OPTIONS') {
            add_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS, PUT, PATCH, DELETE, REPORT, PROPFIND, PROPPATCH, MKCOL, COPY, MOVE, LOCK, UNLOCK, MKWORKSPACE, UPDATE, CHECKIN, CHECKOUT, UNCHECKOUT, VERSION-CONTROL, SEARCH, LABEL' always;
            add_header 'Access-Control-Allow-Headers' 'Origin, Content-Type, Authorization' always;
            add_header 'Access-Control-Allow-Origin' "*" always;
            add_header 'Access-Control-Allow-Credentials' 'true' always;
            add_header Expires 0;
            add_header Cache-Control "no-store, no-cache, must-revalidate, max-age=0";
            return 204;
        }

        if ($request_method != 'OPTIONS') {
            add_header 'Access-Control-Allow-Origin' "*" always;
            add_header 'Access-Control-Allow-Credentials' 'true';
        }

        proxy_pass http://tcalendar-side-service:80;
    }
}